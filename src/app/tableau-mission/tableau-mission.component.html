<link rel="stylesheet" href="/assets/font-awesome-4.7.0/css/font-awesome.min.css">
<h1 *ngIf=" (item == 'employe' && item != null)">
    Gestion des Missions</h1>
<h1 *ngIf=" ( (item == 'manager' || item == 'admin') && item != null)">Validation des missions</h1>

<table class="table table-hover table-bordered">
    <thead>
        <th>
            Date de début
            <a (click)="sortMissionsDateDebut()"><i class="fa fa-sort" aria-hidden="true"></i></a>
        </th>
        <th>
            Date de Fin
            <a (click)="sortMissionsDateFin()"><i class="fa fa-sort" aria-hidden="true"></i></a></th>
        <th>Nature</th>
        <th>Départ</th>
        <th>Arrivée</th>
        <th>Transport</th>
        <th *ngIf=" ( item == 'admin' && item != null) ">
            Statut
        </th>
        <th *ngIf=" ( item == 'employe' && item != null) ">
            Statut
            <a (click)="sortMissionStatut()"><i class="fa fa-sort" aria-hidden="true"></i></a>
        </th>
        <th>Actions</th>
    </thead>
    <tbody>

        <tr *ngFor="let mission of missions">

            <!-- <td>{{mission.dateDebut.year}}/{{mission.dateDebut.monthValue}}/{{mission.dateDebut.dayOfMonth}}</td> -->
            <!-- <td>{{mission.dateFin.year}}/{{mission.dateFin.monthValue}}/{{mission.dateFin.dayOfMonth}}</td> -->
            <td>{{mission.dateDebut | date :'dd-MM-yyyy' }}</td>
            <td>{{mission.dateFin | date :'dd-MM-yyyy'}}</td>
            <td>{{mission.nature.nom}}</td>
            <td>{{mission.villeDepart}}</td>
            <td>{{mission.villeArrivee}}</td>
            <td>{{mission.transport}}</td>
            <td *ngIf=" ( item == 'employe' && item != null) ">
                {{mission.statut}}
            </td>
            <td *ngIf=" ( item == 'employe' && item != null) ">
                <button *ngIf='(mission.statut == "INITIALE" || mission.statut == "REJETEE")' class="btn-outline-primary" href="/ajouter/mission.id">
              <img src="/assets/open-iconic-master/svg/pencil.svg" style="width: 2rem; height: 1rem; cursor: pointer;" />                
            </button>
                <button (click)="validerSuppression(mission)" class="btn-outline-danger">
                <img src="/assets/open-iconic-master/svg/trash.svg" style="width: 2rem; height: 1rem; cursor: pointer;" />
              </button>
            </td>
            <td *ngIf=" ( item == 'manager' && item != null) ">
                <button (click)="validerMission(mission.id)" class="btn-outline-success"><img src="/assets/open-iconic-master/svg/check.svg" style="width: 2rem; height: 1rem; cursor: pointer;" /></button>&nbsp;
                <button (click)="rejeterMission(mission.id)" class="btn-outline-danger"><img src="/assets/open-iconic-master/svg/minus.svg" style="width: 2rem; height: 1rem; cursor: pointer;" /></button>
            </td>
            <td *ngIf=" ( item == 'admin' && item != null) ">
                {{mission.statut}}
            </td>
            <td *ngIf=" ( item == 'admin' && item != null) ">
                <button (click)="validerMission(mission.id)" class="btn-outline-success"><img src="/assets/open-iconic-master/svg/check.svg" style="width: 2rem; height: 1rem; cursor: pointer;" /></button>&nbsp;
                <button (click)="rejeterMission(mission.id)" class="btn-outline-danger"><img src="/assets/open-iconic-master/svg/minus.svg" style="width: 2rem; height: 1rem; cursor: pointer;" /></button>
            </td>
    </tbody>
</table>
<div class="offset-md-9 col-md-3">Demander une mission
    <a routerLink="/missions/ajouter" RouterLinkActive="active-link" class="btn-primary"><img src="/assets/open-iconic-master/svg/plus.svg" style="width: 2rem; height: 1rem; cursor: pointer;" /></a>
</div>

<div *ngIf="suppression==true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirmation de suppression</h5>
                <button type="button" class="close" (click)="suppression=false" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <p>Voulez-vous supprimer la mission suivante ?</p>
                <p>Date de debut : {{missionASupprimer.dateDebut.year}}/{{missionASupprimer.dateDebut.monthValue}}/{{missionASupprimer.dateDebut.dayOfMonth}}</p>
                <p>Date de fin : {{missionASupprimer.dateFin.year}}/{{missionASupprimer.dateFin.monthValue}}/{{missionASupprimer.dateFin.dayOfMonth}}</p>
                <p>Nature de mission : {{missionASupprimer.nature.nom}}</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" (click)="suppression=false">Annuler</button>
                <button type="button" class="btn btn-success" (click)="supprimer(missionASupprimer.id)">Valider</button>
            </div>
        </div>
    </div>
</div>